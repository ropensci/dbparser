<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Summary • dbparser</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Summary"><meta property="og:image" content="https://docs.ropensci.org/dbparser/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">dbparser</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="articles/dbparser.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/dbparser_2_2.html">Introducing dbparser 2.2.0</a></li>
    <li><a class="dropdown-item" href="articles/drugbank_nside.html">Integrated Pharmacovigilance: Linking DrugBank, OnSIDES, and TWOSIDES</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/dbparser" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>Summary</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/dbparser/blob/HEAD/paper.md" class="external-link"><code>paper.md</code></a></small>
    </div>


<div id="summary" class="section level1">

<p><code>dbparser</code> is an rOpenSci peer-reviewed R package that provides a unified framework for parsing and integrating major pharmacological and pharmacovigilance databases into standardized, analysis-ready R objects. The package currently supports three essential drug information resources: DrugBank [@wishart2018drugbank], OnSIDES [@galeano2022onsides] and TWOSIDES [@tatonetti2012data]. Each database is parsed into a consistent nested list structure called a <code>dvobject</code>, which preserves complex relational hierarchies while enabling seamless integration across databases. By providing high-performance parsing functions, chainable merge operations, and comprehensive metadata tracking, <code>dbparser</code> eliminates a significant bottleneck in computational pharmacology research and enables reproducible, large-scale drug safety analyses that would otherwise require substantial custom development effort.</p>
</div>
<div class="section level1">
<h1 id="statement-of-need">Statement of Need<a class="anchor" aria-label="anchor" href="#statement-of-need"></a></h1>
<p>Pharmacological research increasingly relies on the integration of heterogeneous data sources to understand drug mechanisms, predict adverse effects, and identify drug-drug interactions. Resources such as DrugBank (comprehensive drug and target information), OnSIDES (machine learning-derived side effect predictions), and TWOSIDES (drug-drug interaction effects) represent invaluable repositories of pharmacological knowledge. However, accessing and integrating these databases presents substantial technical challenges that impede research progress.</p>
<p>Each database employs distinct file formats and structural conventions: DrugBank distributes data as deeply nested XML with complex entity relationships; OnSIDES provides multiple relational CSV files requiring careful joining; TWOSIDES offers compressed flat files with different identifier systems. Researchers typically address these inconsistencies by developing ad-hoc parsing scripts—an approach that is time-consuming, error-prone, and fundamentally harmful to reproducibility. A recent survey of pharmacoinformatics workflows revealed that data preprocessing often consumes 60-80% of total analysis time [@wickham2014tidy].</p>
<p>The R ecosystem, despite its strength in statistical analysis and visualization, lacks dedicated tools for pharmacological database integration. While Bioconductor [@gentleman2004bioconductor] provides excellent infrastructure for genomics data, no equivalent standardized framework exists for drug databases. Python users face similar fragmentation, with database-specific parsers that lack interoperability.</p>
<p><code>dbparser</code> addresses this gap by providing:</p>
<ol style="list-style-type: decimal"><li>
<strong>Unified parsing functions</strong> that transform heterogeneous database formats into a consistent <code>dvobject</code> structure</li>
<li>
<strong>Chainable integration functions</strong> that link databases through common identifiers (DrugBank IDs, RxCUI, PubChem CIDs)</li>
<li>
<strong>Rich metadata preservation</strong> that maintains provenance information essential for reproducible research</li>
<li>
<strong>High-performance implementations</strong> leveraging <code>data.table</code> [@dowle2023datatable] for efficient processing of multi-gigabyte files</li>
</ol><p>As an rOpenSci peer-reviewed package, <code>dbparser</code> meets rigorous standards for code quality, documentation, testing, and community practices—providing researchers with confidence in its reliability and long-term sustainability.</p>
</div>
<div class="section level1">
<h1 id="functionality">Functionality<a class="anchor" aria-label="anchor" href="#functionality"></a></h1>
<div class="section level2">
<h2 id="modular-parsing-architecture">Modular Parsing Architecture<a class="anchor" aria-label="anchor" href="#modular-parsing-architecture"></a></h2>
<p><code>dbparser</code> provides dedicated parsing functions for each supported database:</p>
<table class="table"><colgroup><col width="21%"><col width="21%"><col width="29%"><col width="27%"></colgroup><thead><tr><th>Function</th>
<th>Database</th>
<th>Input Format</th>
<th>Key Content</th>
</tr></thead><tbody><tr><td><code><a href="reference/parseDrugBank.html">parseDrugBank()</a></code></td>
<td>DrugBank</td>
<td>XML</td>
<td>Drug properties, targets, pathways, interactions</td>
</tr><tr><td><code><a href="reference/parseOnSIDES.html">parseOnSIDES()</a></code></td>
<td>OnSIDES</td>
<td>Relational CSVs</td>
<td>ML-derived side effects with confidence scores</td>
</tr><tr><td><code><a href="reference/parseTWOSIDES.html">parseTWOSIDES()</a></code></td>
<td>TWOSIDES</td>
<td>Compressed CSV</td>
<td>Drug-drug interaction adverse events</td>
</tr></tbody></table><p>Each parser returns a <code>dvobject</code>—a deeply nested list that preserves the original database’s relational structure while providing consistent access patterns. The <code>dvobject</code> contains three primary components: (1) parsed data tables in tidy format [@wickham2014tidy], (2) comprehensive metadata including database version, parse timestamp, and schema information, and (3) relationship mappings that document cross-table linkages.</p>
</div>
<div class="section level2">
<h2 id="integration-engine">Integration Engine<a class="anchor" aria-label="anchor" href="#integration-engine"></a></h2>
<p>The package implements a “hub-and-spoke” integration model with DrugBank serving as the central hub. Integration functions link external databases to DrugBank entries through standardized identifiers:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chain multiple databases into a unified object</span></span>
<span><span class="va">integrated_db</span> <span class="op">&lt;-</span> <span class="va">drugbank_db</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="reference/merge_drugbank_onsides.html">merge_drugbank_onsides</a></span><span class="op">(</span><span class="va">onsides_db</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="reference/merge_drugbank_twosides.html">merge_drugbank_twosides</a></span><span class="op">(</span><span class="va">twosides_db</span><span class="op">)</span></span></code></pre></div>
<p>This design reflects DrugBank’s comprehensive identifier mappings (including RxCUI, PubChem, ChEMBL, and KEGG identifiers) and its role as a reference resource in pharmacological research. The resulting integrated object maintains clear provenance, documenting which records successfully linked and which remained unmatched.</p>
</div>
<div class="section level2">
<h2 id="performance-considerations">Performance Considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a></h2>
<p><code>dbparser</code> employs several strategies to handle large databases efficiently:</p>
<ul><li>
<strong>Streaming XML parsing</strong> via <code>xml2</code> [@wickham2023xml2] for memory-efficient DrugBank processing</li>
<li>
<strong><code><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">data.table::fread()</a></code></strong> for high-speed CSV parsing with automatic type inference</li>
<li>
<strong>Lazy evaluation</strong> options for selective loading of database components</li>
<li>
<strong>Progress reporting</strong> for long-running parse operations</li>
</ul><p>Typical parsing times on commodity hardware (8-core CPU, 16GB RAM): DrugBank full XML (~2.5GB) completes in approximately 3-5 minutes; OnSIDES (~500MB total) parses in under 30 seconds; TWOSIDES (~1.2GB) completes in approximately 1 minute.</p>
</div>
</div>
<div class="section level1">
<h1 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a></h1>
<p>The following example demonstrates a complete workflow for investigating anticoagulant side effects across integrated databases:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/dbparser/">dbparser</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parse individual databases</span></span>
<span><span class="va">drugbank_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/parseDrugBank.html">parseDrugBank</a></span><span class="op">(</span><span class="st">"drugbank_all_full_database.xml"</span><span class="op">)</span></span>
<span><span class="va">onsides_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/parseOnSIDES.html">parseOnSIDES</a></span><span class="op">(</span><span class="st">"onsides_v2.0.0/"</span><span class="op">)</span></span>
<span><span class="va">twosides_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/parseTWOSIDES.html">parseTWOSIDES</a></span><span class="op">(</span><span class="st">"twosides.csv.gz"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create integrated database object</span></span>
<span><span class="va">merged_db</span> <span class="op">&lt;-</span> <span class="va">drugbank_db</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/merge_drugbank_onsides.html">merge_drugbank_onsides</a></span><span class="op">(</span><span class="va">onsides_db</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/merge_drugbank_twosides.html">merge_drugbank_twosides</a></span><span class="op">(</span><span class="va">twosides_db</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify anticoagulant drugs via DrugBank categories</span></span>
<span><span class="va">anticoagulant_ids</span> <span class="op">&lt;-</span> <span class="va">merged_db</span><span class="op">$</span><span class="va">drugbank</span><span class="op">$</span><span class="va">drugs</span><span class="op">$</span><span class="va">categories</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">category</span> <span class="op">==</span> <span class="st">"Anticoagulants"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">drugbank_id</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyze side effect frequencies from OnSIDES</span></span>
<span><span class="va">side_effects</span> <span class="op">&lt;-</span> <span class="va">merged_db</span><span class="op">$</span><span class="va">integrated_data</span><span class="op">$</span><span class="va">drugbank_onsides</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">drugbank_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">anticoagulant_ids</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">meddra_name</span>, sort <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"frequency"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">side_effects</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;            meddra_name frequency</span></span>
<span><span class="co">#&gt; 1          Haemorrhage       847</span></span>
<span><span class="co">#&gt; 2        Anaemia       623</span></span>
<span><span class="co">#&gt; 3   Thrombocytopenia       412</span></span>
<span><span class="co">#&gt; 4          Ecchymosis       389</span></span>
<span><span class="co">#&gt; 5        Epistaxis       356</span></span></code></pre></div>
<p>This analysis validates against known clinical findings—hemorrhagic events represent the primary safety concern for anticoagulant therapy [@garcia2012anticoagulant]. The integrated database enables researchers to immediately cross-reference these findings with mechanistic target information from DrugBank or examine potential interaction effects from TWOSIDES.</p>
</div>
<div class="section level1">
<h1 id="quality-assurance">Quality Assurance<a class="anchor" aria-label="anchor" href="#quality-assurance"></a></h1>
<p><code>dbparser</code> maintains high software quality standards through:</p>
<ul><li>
<strong>Comprehensive testing</strong>: &gt;85% code coverage via <code>testthat</code> [@wickham2011testthat], with unit tests validating parsing accuracy against known database content</li>
<li>
<strong>Continuous integration</strong>: Automated testing on Linux, macOS, and Windows via GitHub Actions</li>
<li>
<strong>Documentation</strong>: Complete function documentation, vignettes demonstrating common workflows, and a pkgdown documentation website</li>
<li>
<strong>rOpenSci peer review</strong>: Rigorous evaluation of code quality, documentation, and community practices</li>
</ul></div>
<div class="section level1">
<h1 id="availability">Availability<a class="anchor" aria-label="anchor" href="#availability"></a></h1>
<p><code>dbparser</code> is available from CRAN (<code>install.packages("dbparser")</code>) and the development version is hosted on GitHub (<a href="https://github.com/ropensci/dbparser" class="external-link uri">https://github.com/ropensci/dbparser</a>). Documentation is available at <a href="https://docs.ropensci.org/dbparser/" class="uri">https://docs.ropensci.org/dbparser/</a>. The package is released under the MIT license. Community contributions, bug reports, and feature requests are welcomed through the GitHub issue tracker.</p>
</div>
<div class="section level1">
<h1 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a></h1>
<p>We gratefully acknowledge the creators and maintainers of DrugBank, OnSIDES, TWOSIDES, SIDER, and OFFSIDES for making their invaluable data resources available to the research community. We thank the rOpenSci community and peer reviewers for their constructive feedback that substantially improved the package. Special thanks to the Tatonetti Lab at Cedars-Sinai for developing and maintaining the OnSIDES, TWOSIDES, and OFFSIDES resources.</p>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h1>
</div>


  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://mohammedfcis.github.io" class="external-link">Mohammed Ali</a>, Ali Ezzat.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

